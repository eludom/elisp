;
; George Jones' collection of org-mode hacks
;

* gmj org mode function definitions
** gmj-org-demote
*** code
#+begin_src emacs-lisp
(defun gmj-org-demote (howManyTimes)
  "demote current and next /howManyTimes/ -1 org mode elements.

  TODO List
    - Operate on region
    - Need error handling on (org-forward-element) with negagive counts.
     Starting on '**** a' below with a negative 2 count returns an error

     * one
     ***** a
     ***** b
     * c
     * two
  "
  
  (interactive "p")
  (let ((count 0))
    (while (< count (abs howManyTimes))
      (progn
	(if (< howManyTimes 0)
	    (org-promote-subtree)
	  (org-demote-subtree))
        (message "org-forward-element")
	(org-forward-element)
        (message "incr count")
	(setq count (+ count 1))))))

#+end_src
** To Do List

** gmj-org-example
**** code
#+BEGIN_SRC emacs-lisp
(defun gmj-org-example ()
    "Insert org mode #+[begin|end]_example around region

#+begin_example
REGION
#+end_example
Type \\[gmj-org-example] to insert #+begin_example ... #+end_example aorund region
"
  (interactive)
  (let (p1 p2 inputText)
    (if (use-region-p)
        (progn
          (setq p1 (region-beginning) )
          (setq p2 (region-end) )
          )
      (let ((bds (bounds-of-thing-at-point 'symbol)))
        (setq p1 (car bds) )
        (setq p2 (cdr bds) ) ) )

    (goto-char p2)
    (insert "
#+end_example")
    (goto-char p1)
    (insert "+#begin_example
")
    ))
#+END_SRC

#+RESULTS:
: gmj-org-example

**** To Do List
**** TODO - insert \n explicitly, not in quotes
**** TODO - Do auto-indentation 
**** TODO - Deal with null region



* gmj-org-mode-config hook
#+BEGIN_SRC emacs-lisp
(defun gmj-org-mode-config ()
  "For use in `org-mode-hook'."
  (message "Runing gmj-org-mode-cofig")
  (local-set-key (kbd "C-c d") 'gmj-org-demote)
  (local-set-key (kbd "C-c e") 'gmj-org-example)
  ;(local-set-key (kbd "C-c C-p") nil) ; example of remove a key
  ;; more here
  )

;; add to hook
(add-hook 'org-mode-hook 'gmj-org-mode-config)
#+END_SRC

#+RESULTS:
| gmj-org-mode-config | my-org-mode-config | (lambda nil (local-set-key \357 (quote org-mime-org-buffer-htmlize))) | (closure (org-inlinetask-min-level buffer-face-mode-face org-mode-map org-tbl-menu org-org-menu org-struct-menu org-entities org-last-state org-id-track-globally org-clock-start-time texmathp-why remember-data-file org-agenda-tags-todo-honor-ignore-options iswitchb-temp-buflist calc-embedded-open-mode calc-embedded-open-formula calc-embedded-close-formula align-mode-rules-list org-emphasis-alist org-emphasis-regexp-components org-export-registered-backends org-modules org-babel-load-languages t) nil (add-hook (quote change-major-mode-hook) (quote org-show-block-all) (quote append) (quote local))) | (closure (org-bracket-link-regexp org-src-window-setup *this* org-babel-confirm-evaluate-answer-no org-src-preserve-indentation org-src-lang-modes org-edit-src-content-indentation org-babel-library-of-babel t) nil (add-hook (quote change-major-mode-hook) (quote org-babel-show-result-all) (quote append) (quote local))) | org-babel-result-hide-spec | org-babel-hide-all-hashes |

